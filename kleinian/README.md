# Introduction
クライン群を扱った書籍に"インドラの真珠"がある．この本は，数学者以外にクライン群の魅力を伝えるために書かれている．中には研究者レベルの高度な内容も出てくるが，高校卒業レベルの数学と簡単なプログラムを組む能力があれば，読み進めることができる．

数学的に厳密な話はインドラの真珠や双曲幾何学への招待といった双曲幾何学の入門書籍を当たってもらうことにして，ここではざっくりとした説明に留めておく．

なにはともあれインドラの真珠を読み進めるのが早い．インドラの真珠で紹介されるレンダリング手法を軽く紹介した後に筆者らが開発した手法とその他の手法を紹介する．
## What is the word "Group"?
簡単に語を
ここで話題にする"群"(Group)という語は変換の集まりと思うことにする．
中でも，クライン群はメビウス変換を群の構成要素にもつ群の中で離散性を持つものである．
ここで扱う変換にはラベルがつけられる．
## Mobius Transformations
メビウス変換は一次分数変換とも呼ばれ，以下のように表現される
$$f(z) = \frac{az + b}{cz + d}$$
2x2複素数行列として表現できる．メビウス変換は等角性や円円対応といった性質を持つ．
## Inversion
ここで，重要な変換である円の反転をみておく．
円に関する反転は円の中心を無限遠店に，無限遠点を円の中心に持ってくる操作である．
式は以下のようになる．  
{% math %} \frac{(P - C) * R^2}{distance(P, C)^2} {% endmath %}  
![CircleInversion](img/inversion.png)  
上の画像では黒い円による反転でいくつかの図形を映した像を描いている．直線は円に，円は円に移る．変換の前後で角度は変わらない（つまり，緑色の四角形の内角は変換後も直角を保つ）が面積は大きく変化する．また，半径無限の円は直線と考えることができ，その反転は直線に関する反転となる．
同様にして球による反転も定義することができる．

# Visualization
群の可視化手法には大きく分けて２つある．一つは変換の軌道を見る方法と極限集合を見る方法である．
# The orbit
特定の図形を群の元で移していき，その軌道を見る．
４つの円の反転を生成元に持つ群の可視化を考える．それぞれの円の反転は自分以外の円を自分の内側に移す．よって，それぞれの円の内側には３つの円が移され，１２個の小円ができる．次に４つの円の反転を新たに表れた小円にも適用する．このことを繰り返すと，以下の画像のように，円が入れ子状につらなる図を得ることができる．これが群の生成元による軌道である．また，円列の極限を極限集合とよぶ．
以下はJavaScriptで４つの円の反転で構成される群の軌道を表す円列を計算するコードである．
このアルゴリズムは変換で構成される木構造を幅優先探索で探索することに等しい．
インドラの真珠では以下のように，ショットキー群(Schottky Groups)における生成元であるショットキー円の軌道を描画している．ショットキー群はショットキー変換を構成要素に持つ群である．ショットキー変換は円をペアで構成され，相手の円の外側を自分の円の内側に，自分の円の外側を相手の円の内側へと変換する．この変換は二つの円盤の反転と同一視できる場合がある．

# The Limit Set
前節でみた極限集合を直接描くアプローチもある．円の軌道を描く方法は，生成元が限定的になってしまう．メビウス変換は２ｘ２の複素数行列で表現できるため，８つのパラメータがある．ただし，このままでは自由度が高すぎるため，適切に制限を加えた群の”レシピ”が存在する．
生成元や，探索を深くするごとに指数オーダーで計算量が増えてしまう．木構造の探索は並列化が難しいため，
最近のOpenCLやCUDAといった並列計算プラットフォームではDynamic Parallelismという機能をサポートしている．この機能を用いることで，極限集合，軌道の並列計算を行うことができる．

非離散的と呼び，変換が収束しなくなる．
クライン群ではなくなる．しばしば興味深い現象，図像に出くわす．

# Iterated Inversion System
円や球の反転で構成される群の軌道を高速に描画するためのアルゴリズム，Iterated Inversion System (IIS)を開発した．
このアルゴリズムは円や球の座標と半径を直接計算するこれまでのアプローチに対して，ある点が属する円や球の深さを特定する．
三次元形状をレンダリングする際にはレイマーチングと呼ばれるレイトレーシングの手法を用いる．
# Geometrical Representation of Mobius Transformations
IISを用いることで，円や球をベースにしたクライン群を含むフラクタルが高速に描画できるようになり
インタラクティブに構成するソフトウェアを開発した．
円や球を用いることで，生成元と可視化される図形の間の関係性が理解しやすい．そこで，その他のメビウス変換についても円や球の反転の合成で構成することを考えた．
多くの場合，行列表現で与えられる．高次元のクライン群（インドラの真珠であつかうクライン群はすべて二次元の図に帰着させることができる）になると，四元数行列となり，パラメータ数はさらに増大する．そこで筆者らはすべてのメビウス変換を円や球の反転で構成することを考えた．そうすることで幾何学的な直観を得ることができる．また，IISを用いることで複雑な生成元をもつ群もリアルタイムに可視化することができる．このことは，研究者や学習者だけでなく，フラクタルアーティストにも有益なものとなるだろう．この方法に関する論文はBridges2016に投稿中である．
# Interactive Image Sequences Converging to Fractals
Iterated Function Systemを拡張したHyperbolic Iterated Function Systemを提案している．
https://www-m10.ma.tum.de/bin/view/Lehrstuhl/AaronMontagKleinian

# 
また，2016年11月にクライン群の極限集合のDistance Estimationを行う式がFractal ForumsにおいてJos LeysとKnightyによって開発された．
http://www.fractalforums.com/3d-fractal-generation/an-escape-tim-algorithm-for-kleinian-group-limit-sets/

# 4 Dimensional Kleinian Groups
インドラの真珠で紹介されるクライン群は複素平面にのみ作用する

四元数を用いることで，三次元空間に作用するメビウス変換を定義することができる．
これはspk(1, 1)と呼ばれ，2x2の四元数行列で表現される．
パラメータが多くなりすぎるため，あまり研究は進んでいない．
例えば，以下の論文で佐久川氏が述べているスライスや離散条件など

# Quasi Fuchsian 3D Fractals
三次元フラクタルのレンダリングに大きな影響を与えた．
四次元クライン群の一種である
Distance Estimationの式がKnightyにより開発され，高速にレンダリングすることができる．

球面体をその周囲の球で反転させていくことにより得ることができる．
蔭山氏が2016年にまとめている．

# Once Punctured Torus Groups
Once Punctured Torus Groupsはクライン群の一種である．OPTiという描画ソフトウェアが有名である．
描画や離散性判定のためのアルゴリズムが和田氏によりまとめられている．
ベアズスライスとよばれる．OPTiでは，ベアズスライスも同時に描画される．
