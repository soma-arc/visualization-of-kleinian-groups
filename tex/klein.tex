%#!platex main.tex

\section{Kleinian Groups}
クライン群について学習する際には書籍『インドラの真珠』を読むことを勧める．この章では，『インドラの真珠』で記述のあるレンダリング手法に触れた後に最近開発された効率的な描画手法を紹介する．
インドラの真珠は数学者以外にもクライン群の魅力を伝えるために書かれた．中には研究者レベルの高度な内容も出てくるが，高校卒業レベルの数学と簡単なプログラムを組む能力があれば，自分で図をレンダリングしながら読み進めることができるだろう．
この章ではインドラの真珠で言及のある可視化手法と，筆者らが開発した描画手法を主に述べる．

\subsection{Group}
まず，群という語について確認しておく．ここでは変換の集まりだと考えることにする．例えば，図[1]のような二種類の変換を考えてみよう．この４種類の変換を組み合わせることで，たくさんの変換を作ることができる．イメージである．
クライン群はメビウス変換を生成元にもつ群のなかで離散性という性質を持つものをいう．
ラベルを付けて扱う．

\subsection{Mobius Transformations}
メビウス変換は一次分数変換とも呼ばれ，以下のように表現される．
$f(z) = \frac{az + b}{cz + d}$
また，これを２×２の複素数行列として扱うことで，変換の合成を行列の積とすることができる．メビウス変換は複素数平面上に作用し，等角性や円円対応といった性質をもつ．
図[2]はメビウス変換の中でも重要な役割を持つ，円に関する反転という操作を可視化しあtものである．それぞれの図形は黒い円に関する反転で移されている．緑色の矩形を観察すると，変換の前後で直角が保たれていることがわかる．また，黄色の円は円が保たれている．メビウス変換は角度は保つが形は大きく歪めてしまう．

メビウス変換は繰り返し適用することで，それ以上動かすことのできない点が現れる場合がある．
メビウス変換は固定点の個数で分類することができる．固定点が２個の場合を斜航型変換，固定点が１個の場合を放物型変換，固定点がない場合を楕円型変換と呼ぶ．また斜航型変換の中でも，その係数が正の実数である時，その変換を双曲型変換と呼ぶ場合もある．
クライン群の描画において，メビウス変換の分類は重要である．なぜならば，多くの楕円型変換を含む群はクライン群にはなりえない．また，放物型変換は固定点への収束が遅いという特徴をもつ．これは描画の際に不利益になる．

メビウス変換は２ｘ２の複素数行列で表現できるため，８つのパラメータがある．ただし，このままでは自由度が高すぎるため，適切に制限を加えた群の「レシピ」が作られている．
『インドラの真珠』で使われる「おばあちゃんのレシピ」をみてみよう．
パラメータは二つの複素数と符合となった．綺麗な図が描けるように調整されている．

\subsection{Graph Traversal Approach}
このような語で構成された木はケーリーグラフ（Cayley graph）と呼ばれる．
幅優先探索するか，深さ優先探索するかで描画できるものが変わってくる．

\subsubsection{Rendering the Orbit of Transformations}
群を可視化する．軌道を描くことで群を可視化してみよう．
４つの円の反転を生成元に持つ群の可視化を考える．それぞれの円の反転は自分以外の円を自分の内側に移す．よって，それぞれの円の内側には３つの円が移され，１２個の小円ができる．次に４つの円の反転を新たに表れた小円にも適用する．このことを繰り返すと，以下の画像のように，円が入れ子状につらなる図を得ることができる．これが群の生成元による軌道である．また，円列の極限を極限集合とよぶ．この極限を観察することがクライン群を研究する上で役に立つ．
このアルゴリズムは変換で構成される木構造を幅優先探索で探索することに等しい．おおまかに生成元の作用を調べることに役立つ．
この例では，軌道の元となる図形が生成元と同じであるが，その他の図形でも可能である
図はbugman123氏による作品を参考に筆者が描画したものである．蝶が二つの元の作用で変換された軌道を極限集合とともに描いている．

\subsubsection{Rendering the Limit Set}
前節でみた極限集合を直接描く．主に極限集合を描く方法が使われる．
木構造を探索し，最後に固定点に対して合成した変換を適用することで極限集合の点を求めることができる．

先に述べた平行移動の例では，abABという変換は一周してもとの場所に戻ってきてしまう．同様のことがクライン群の生成元に関しても言える．効率よく描画するためには，うまくこのような元を取り除く必要がある．これを解決するためには有限オートマトンの考えが使われる．これは『Word Processing In Groups』が詳しい

非離散的と呼び，極限集合が収束しなくなり，図が乱れる．この時，その群はクライン群ではなくなる．離散と非離散の境界近くでは図も興味深い形になる．この離散と非離散のパラメータ領域を表す図はスライスと呼ばれる．どのようなパラメータが離散的であるか，すなわちクライン群となるかを調べることがクライン群の研究テーマともなる．

\subsection{Faults of Graph Traversal}
グラフを探索する方法は生成元や，探索を深くするごとに指数オーダーで計算量が増えてしまう．そもそも木構造の探索は並列化が難しいため，時間がかかる．
最新のOpenCLやCUDAといったGPUを用いた並列計算プラットフォームではDynamic Parallelismという機能をサポートしている．この機能を用いることで，極限集合，軌道の並列計算を行うことは可能である．

\subsection{Iterated Inversion System}
筆者らは円や球の反転で構成される群の軌道を高速に描画するためのアルゴリズム，Iterated Inversion System (IIS)を開発した．
このアルゴリズムは円や球の座標と半径を直接計算するこれまでのアプローチに対して，ある点が属する円や球の深さを特定する．
三次元形状をレンダリングする際にはレイマーチングと呼ばれるレイトレーシングの手法を用いる．

\subsection{Geometrical Representation of Mobius Transformations}
IISを用いることで，円や球をベースにしたクライン群を含むフラクタルが高速に描画できるようになりインタラクティブに構成するソフトウェアを開発した．
円や球を用いることで，生成元と可視化される図形の間の関係性が理解しやすい．そこで，その他のメビウス変換についても円や球の反転の合成で構成することを考えた．
多くの場合，行列表現で与えられる．高次元のクライン群（インドラの真珠であつかうクライン群はすべて二次元の図に帰着させることができる）になると，四元数行列となり，パラメータ数はさらに増大する．そこで筆者らはすべてのメビウス変換を円や球の反転で構成することを考えた．そうすることで幾何学的な直観を得ることができる．また，IISを用いることで複雑な生成元をもつ群もリアルタイムに可視化することができる．このことは，研究者や学習者だけでなく，フラクタルアーティストにも有益なものとなるだろう．この方法に関する論文はBridges2016に投稿中である．

\subsection{Other Topics}
この節では

\subsubsection{Other Rendering Methods}
Iterated Inversion Systemを拡張したHyperbolic Iterated Function Systemによって極限集合を描画することに成功した．固定点付近では図に乱れが出るものの，おおむね描画できる．
マスキット群におけるDistance Estimationを開発した．

\subsubsection{Quasi Fuchsian 3-Dimensional Fractals}
三次元フラクタルのレンダリングに大きな影響を与えた．
四次元クライン群の一種である
Distance Estimationの式がKnightyにより開発され，高速にレンダリングすることができる．
球面体をその周囲の球で反転させていくことにより得ることができる．
蔭山氏が2016年にまとめている．

\subsubsection{4-Dimensional Kleinian Groups}
インドラの真珠で紹介されるクライン群は複素平面にのみ作用する
四元数を用いることで，三次元空間に作用するメビウス変換を定義することができる．
これはspk(1, 1)と呼ばれ，2x2の四元数行列で表現される．
パラメータが多くなりすぎるため，あまり研究は進んでいない．
例えば，以下の論文で佐久川氏が述べているスライスや離散条件など

\subsubsection{Once Punctured Torus Groups}
Once Punctured Torus Groupsはクライン群の一種である．OPTiという描画ソフトウェアが有名である．
描画や離散性判定のためのアルゴリズムが和田氏によりまとめられている．
ベアズスライスとよばれる．OPTiでは，ベアズスライスも同時に描画される．
ほとんどが解決された．

\subsection{Further Readings}
この章の最後に，クライン群のより数学的な背景を学習するための書籍をいくつか挙げておく．
