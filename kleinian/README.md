# Introduction
クライン群を扱った書籍に"インドラの真珠"がある．この本は，数学者以外にクライン群の魅力を伝えるために書かれている．中には研究者レベルの高度な内容も出てくるが，高校卒業レベルの数学と簡単なプログラムを組む能力があれば，読み進めることができる．

数学的に厳密な話はインドラの真珠や双曲幾何学への招待といった双曲幾何学の入門書籍を当たってもらうことにして，ここではざっくりとした説明に留めておく．

なにはともあれインドラの真珠を読み進めるのが早い．インドラの真珠で紹介されるレンダリング手法を軽く紹介した後に筆者らが開発した手法とその他の手法を紹介する．
## Group
ここで話題にする"群"(Group)という語は変換の集まりと考えることにする．群の生成元（Generator）や元と呼ぶ．
中でも，クライン群はメビウス変換を群の構成要素にもつ群の中で離散性を持つものである．
また元にはラベルを付けて扱う．
## Mobius Transformations
メビウス変換は一次分数変換とも呼ばれ，以下のように表現される
$$f(z) = \frac{az + b}{cz + d}$$
2x2複素数行列として表現できる．メビウス変換は等角性や円円対応といった性質を持つ．

# Visualization
インドラの真珠で用いられる群の可視化手法には大きく分けて２つある．特定の図を群の生成元で変換し続けてその軌道を描画する方法と群の極限集合を描画する方法である．
# The orbit
特定の図形を群の元で移していき，その軌道を見る．
４つの円の反転を生成元に持つ群の可視化を考える．それぞれの円の反転は自分以外の円を自分の内側に移す．よって，それぞれの円の内側には３つの円が移され，１２個の小円ができる．次に４つの円の反転を新たに表れた小円にも適用する．このことを繰り返すと，以下の画像のように，円が入れ子状につらなる図を得ることができる．これが群の生成元による軌道である．また，円列の極限を極限集合とよぶ．この極限を観察することがクライン群を研究する上で役に立つ．
このアルゴリズムは変換で構成される木構造を幅優先探索で探索することに等しい．
おおまかに生成元を作用を見ることに役立つ．
この画像はbugman123氏による作品を参考に筆者が描画したものである．作品を豊かにすることもできるだろう．

# The Limit Set
前節でみた極限集合を直接描くこともできる．インドラの真珠ではこの方法が主に使われる．
円の軌道を描く方法は，生成元が限定的になってしまう．例えば
メビウス変換は２ｘ２の複素数行列で表現できるため，８つのパラメータがある．ただし，このままでは自由度が高すぎるため，適切に制限を加えた群の”レシピ”が存在する．
木構造を探索し，最後に固定点に対して合成した変換を適用することで極限集合の点を求めることができる．

先に述べた平行移動の例では，abABという変換は一周してもとの場所に戻ってきてしまう．同様のことがクライン群の生成元に関しても言える．効率よく描画するためには，うまくこのような元を取り除く必要がある．これを解決するためには有限オートマトンの考えが使われる．これは書籍，Word Processing In Groupsが詳しい

極限が収束しなくなる．
非離散的と呼び，極限集合が収束しなくなる．この境界領域では，
クライン群ではなくなる．しばしば興味深い現象，図像に出くわす．

この離散と非離散のパラメータ領域を表す図はスライスと呼ばれる．
どのようなパラメータが離散的，すなわちクライン群となるかを調べることがクライン群の研究テーマともなる．

ただし，この方法は生成元や，探索を深くするごとに指数オーダーで計算量が増えてしまう．木構造の探索は並列化が難しいため，時間がかかる．
最新のOpenCLやCUDAといった並列計算プラットフォームではDynamic Parallelismという機能をサポートしている．この機能を用いることで，極限集合，軌道の並列計算を行うことができる．

# Iterated Inversion System
円や球の反転で構成される群の軌道を高速に描画するためのアルゴリズム，Iterated Inversion System (IIS)を開発した．
このアルゴリズムは円や球の座標と半径を直接計算するこれまでのアプローチに対して，ある点が属する円や球の深さを特定する．
三次元形状をレンダリングする際にはレイマーチングと呼ばれるレイトレーシングの手法を用いる．
# Geometrical Representation of Mobius Transformations
IISを用いることで，円や球をベースにしたクライン群を含むフラクタルが高速に描画できるようになり
インタラクティブに構成するソフトウェアを開発した．
円や球を用いることで，生成元と可視化される図形の間の関係性が理解しやすい．そこで，その他のメビウス変換についても円や球の反転の合成で構成することを考えた．
多くの場合，行列表現で与えられる．高次元のクライン群（インドラの真珠であつかうクライン群はすべて二次元の図に帰着させることができる）になると，四元数行列となり，パラメータ数はさらに増大する．そこで筆者らはすべてのメビウス変換を円や球の反転で構成することを考えた．そうすることで幾何学的な直観を得ることができる．また，IISを用いることで複雑な生成元をもつ群もリアルタイムに可視化することができる．このことは，研究者や学習者だけでなく，フラクタルアーティストにも有益なものとなるだろう．この方法に関する論文はBridges2016に投稿中である．
# Interactive Image Sequences Converging to Fractals
Iterated Function Systemを拡張したHyperbolic Iterated Function Systemを提案している．
https://www-m10.ma.tum.de/bin/view/Lehrstuhl/AaronMontagKleinian

# 
また，2016年11月にクライン群の極限集合のDistance Estimationを行う式がFractal ForumsにおいてJos LeysとKnightyによって開発された．
http://www.fractalforums.com/3d-fractal-generation/an-escape-tim-algorithm-for-kleinian-group-limit-sets/

# 4 Dimensional Kleinian Groups
インドラの真珠で紹介されるクライン群は複素平面にのみ作用する

四元数を用いることで，三次元空間に作用するメビウス変換を定義することができる．
これはspk(1, 1)と呼ばれ，2x2の四元数行列で表現される．
パラメータが多くなりすぎるため，あまり研究は進んでいない．
例えば，以下の論文で佐久川氏が述べているスライスや離散条件など

# Quasi Fuchsian 3D Fractals
三次元フラクタルのレンダリングに大きな影響を与えた．
四次元クライン群の一種である
Distance Estimationの式がKnightyにより開発され，高速にレンダリングすることができる．
球面体をその周囲の球で反転させていくことにより得ることができる．
蔭山氏が2016年にまとめている．

# Once Punctured Torus Groups
Once Punctured Torus Groupsはクライン群の一種である．OPTiという描画ソフトウェアが有名である．
描画や離散性判定のためのアルゴリズムが和田氏によりまとめられている．
ベアズスライスとよばれる．OPTiでは，ベアズスライスも同時に描画される．


https://www-m10.ma.tum.de/bin/view/Lehrstuhl/AaronMontagKleinian
# Further Readings
最後に，クライン群のより数学的な背景を学習するための書籍をいくつか挙げておく．
双曲幾何学に関する書籍には双曲幾何学への招待がある．

